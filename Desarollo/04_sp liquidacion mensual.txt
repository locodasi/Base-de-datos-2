delimiter $$
CREATE PROCEDURE Calcular_Liquidacion_mensual()
BEGIN

INSERT INTO liquidacion ()(
SELECT h.legajo, h.proyecto, SUM(h.horas) AS horas_trabajadas, MONTH (NOW()) AS mes
FROM horas_rendidas h
WHERE MONTH(h.dia)=MONTH (NOW()) OR MONTH(h.hasta) = MONTH(NOW())
GROUP BY h.legajo,h.proyecto
);

end
$$